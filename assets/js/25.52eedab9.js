(window.webpackJsonp=window.webpackJsonp||[]).push([[25],{305:function(t,e,n){"use strict";n.r(e);var s=n(14),a=Object(s.a)({},(function(){var t=this,e=t._self._c;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",{attrs:{id:"jwt解析token失败问题"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#jwt解析token失败问题"}},[t._v("#")]),t._v(" jwt解析token失败问题")]),t._v(" "),e("h2",{attrs:{id:"问题描述"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#问题描述"}},[t._v("#")]),t._v(" 问题描述")]),t._v(" "),e("p",[t._v("前置需求：本人接到了一个需求，是做一个WebSocket服务，用于生成token和解析token，由于要能解析token信息且可能不是本服务解析。所以本人就用了JWT来生成token。")]),t._v(" "),e("p",[t._v("问题发生：服务写好后，生成token一切正常，可是解码时就报各种各样的错。")]),t._v(" "),e("div",{staticClass:"language-c# line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("System.ArgumentException: 'IDX12723: Unable to decode the payload '[PII of type 'System.String' is hidden. For more details, see https://aka.ms/IdentityModel/PII.]' as Base64Url encoded string.'\n“IDX12723: Unable to decode the payload \\u0027[PII of type \\u0027System.String\\u0027 is hidden. For more details, see https://aka.ms/IdentityModel/PII.]\\u0027 as Base64Url encoded string.”\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br")])]),e("p",[t._v("反正就是各种解析不了token的错。\n然后通过debug模式，发现解析的payload是乱码。换成自己的电脑就没问题。")]),t._v(" "),e("p",[t._v("尝试解决：通过百度 Google各种搜索引擎搜索后，发现很多类似的问题，先是听从他们的建议：")]),t._v(" "),e("ol",[e("li",[t._v("降低JWT版本")]),t._v(" "),e("li",[t._v("更换JWT生成token的方法\n然后无法解决，再进行自己的尝试：")]),t._v(" "),e("li",[t._v("独立一个控制台应用用于生成token、解析token，发现：直接解析token正常，如果先复制再粘贴回去解析就错误。（当时觉得太难理解了）")]),t._v(" "),e("li",[t._v("基于第一点，我换成自己的电脑测试，发现生成token和解析token都没错。（排除代码问题）")]),t._v(" "),e("li",[t._v("直接重启开发电脑，还是无法解决。")]),t._v(" "),e("li",[t._v("找了web字符串对比工具，发现代码直接保存的token和复制的token一致。（大坑，在解决方案栏目解释）")]),t._v(" "),e("li",[t._v("我直接out穿头")])]),t._v(" "),e("h2",{attrs:{id:"解决方案"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#解决方案"}},[t._v("#")]),t._v(" 解决方案")]),t._v(" "),e("p",[t._v("怀疑是web字符串对比工具的问题，所以我打算用肉眼查看！这一看问题就来了，代码直接保存的token在txt上，我再把这个token复制粘贴，您猜怎么着？token变了！")]),t._v(" "),e("div",{staticClass:"language-txt line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-txt"}},[e("code",[t._v("// 代码保存的token没办法搞进来了，都是错的token\n\n\n// 复制过的token\neyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJobWhLZXkiOiJiNTQ8419uEC2UaRX7itXEQBGMDPvrmRgnZLc5N2EzNiIsInVOYW1lIjoi5rWL6K-V6LSm5Y-3ODgiLCJ1WmgiOiIwMjdEODdBNy02NDMyLTQ8419uEC2UaRX7itXEQBGMDPvrmRgnZLcuYmYiOjE3MjExODI0MTQ8419uEC2UaRX7itXEQBGMDPvrmRgnZLcxNzIxMTQ8419uEC2UaRX7itXEQBGMDPvrmRgnZLclIiwiYXVkIjoiQ2xpZW50LUFQUCJ9.3z6Ca2ZnsN6EQl_fLe8xuZHSh3QBZABDo5xYiQeRR7k\n\n\n//问题所在\n复制过的token会随机将token串中一串替换成TQ8419uEC2UaRX7itXEQBGMDPvrmRgnZLc，但是长度又变得不多\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br"),e("span",{staticClass:"line-number"},[t._v("5")]),e("br"),e("span",{staticClass:"line-number"},[t._v("6")]),e("br"),e("span",{staticClass:"line-number"},[t._v("7")]),e("br"),e("span",{staticClass:"line-number"},[t._v("8")]),e("br"),e("span",{staticClass:"line-number"},[t._v("9")]),e("br")])]),e("p",[e("strong",[t._v("我擦咧，至此发现是电脑剪切板问题！一复制进剪切板token就是错的，怪不得他喵的用web字符串对比不出来，对比的两个都是错误的token")])]),t._v(" "),e("p",[t._v("后面换成不经过剪贴板的解析就恢复正常。。。")])])}),[],!1,null,null,null);e.default=a.exports}}]);