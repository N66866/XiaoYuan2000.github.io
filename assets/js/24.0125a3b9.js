(window.webpackJsonp=window.webpackJsonp||[]).push([[24],{306:function(a,s,t){"use strict";t.r(s);var r=t(14),v=Object(r.a)({},(function(){var a=this,s=a._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[s("h1",{attrs:{id:"cloudflare-泛播问题"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#cloudflare-泛播问题"}},[a._v("#")]),a._v(" cloudflare 泛播问题")]),a._v(" "),s("h2",{attrs:{id:"场景描述"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#场景描述"}},[a._v("#")]),a._v(" 场景描述")]),a._v(" "),s("h3",{attrs:{id:"前提"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#前提"}},[a._v("#")]),a._v(" 前提")]),a._v(" "),s("p",[a._v("工作时，运维给了一个tls证书和开发测试域名。并且将开发测试域名"),s("strong",[a._v("泛解析")]),a._v("到服务器上。\n然后有个服务是wss使用9300端口进行通信。")]),a._v(" "),s("h3",{attrs:{id:"问题描述"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#问题描述"}},[a._v("#")]),a._v(" 问题描述")]),a._v(" "),s("p",[a._v("由于域名是泛解析：*.xxx.com，我将a.xxx.com 配置上nginx 监听 443 与 域名")]),a._v(" "),s("div",{staticClass:"language-conf line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("server {\n      \n\n        listen 443 ssl http2;\n        server_name a.xxx.com;\n\n        proxy_pass_header Server;\n\n        ssl_certificate cert/local.crt;\n        ssl_certificate_key cert/local.key;\n\t\t\n    }\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br"),s("span",{staticClass:"line-number"},[a._v("7")]),s("br"),s("span",{staticClass:"line-number"},[a._v("8")]),s("br"),s("span",{staticClass:"line-number"},[a._v("9")]),s("br"),s("span",{staticClass:"line-number"},[a._v("10")]),s("br"),s("span",{staticClass:"line-number"},[a._v("11")]),s("br"),s("span",{staticClass:"line-number"},[a._v("12")]),s("br")])]),s("p",[a._v("然后用域名访问nginx，没问题，正常访问。")]),a._v(" "),s("p",[a._v("然后正常跑服务，使用ip+端口访问，服务通信正常。")]),a._v(" "),s("p",[a._v("最后使用域名+端口访问，域名连接不通。")]),a._v(" "),s("h2",{attrs:{id:"解决方法"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#解决方法"}},[a._v("#")]),a._v(" 解决方法")]),a._v(" "),s("h3",{attrs:{id:"问题分析"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#问题分析"}},[a._v("#")]),a._v(" 问题分析")]),a._v(" "),s("p",[a._v("我一顿操作猛如虎，捣鼓了2个小时，最后发现是网络直接不通，还捣鼓了1个多小时的证书和nginx问题。。。。。（家人们谁懂啊！）")]),a._v(" "),s("p",[a._v("知道是网络不通后，先查询dns解析，windows操作方法：使用cmd输入 nslookup 回车，再输入域名：baidu.com")]),a._v(" "),s("div",{staticClass:"language-bat line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("nslookup\n默认服务器:  dns.google\nAddress:  8.8.8.8\n\n> baidu.com\n服务器:  dns.google\nAddress:  8.8.8.8\n\n非权威应答:\n名称:    baidu.com\nAddresses:  39.156.66.10\n          110.242.68.66\n\n>\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br"),s("span",{staticClass:"line-number"},[a._v("7")]),s("br"),s("span",{staticClass:"line-number"},[a._v("8")]),s("br"),s("span",{staticClass:"line-number"},[a._v("9")]),s("br"),s("span",{staticClass:"line-number"},[a._v("10")]),s("br"),s("span",{staticClass:"line-number"},[a._v("11")]),s("br"),s("span",{staticClass:"line-number"},[a._v("12")]),s("br"),s("span",{staticClass:"line-number"},[a._v("13")]),s("br"),s("span",{staticClass:"line-number"},[a._v("14")]),s("br")])]),s("p",[a._v("开始查询自己的域名\n输入域名查询解析ip，我的a.xxx.com查询出来是")]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("          172.67.216.142\n          104.21.86.71\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br")])]),s("p",[a._v("我一看，这不是我的服务器ip哇！然后去ip138查询，查出来一个 "),s("strong",[a._v("泛播")]),a._v(" ！ 震惊了家人们！！")]),a._v(" "),s("p",[a._v("再继续查询资料，发现 cloudflare泛播 是只支持"),s("strong",[a._v("特定端口")]),a._v("的！ 家人们谁懂啊")]),a._v(" "),s("p",[a._v("首先，除了常用的 80 和 443 两个标准端口，Cloudflare还支持11个其它端口。Cloudflare总共支持HTTP端口7个，HTTPS端口6个， 分别是：")]),a._v(" "),s("blockquote",[s("p",[s("strong",[a._v("HTTP协议")]),s("br"),a._v(" "),s("strong",[a._v("80")]),s("br"),a._v("\n8080"),s("br"),a._v("\n8880"),s("br"),a._v("\n2052"),s("br"),a._v("\n2082"),s("br"),a._v("\n2086"),s("br"),a._v("\n2095")])]),a._v(" "),s("blockquote",[s("p",[s("strong",[a._v("HTTPS协议")]),s("br"),a._v(" "),s("strong",[a._v("443")]),s("br"),a._v("\n2053"),s("br"),a._v("\n2083"),s("br"),a._v("\n2087"),s("br"),a._v("\n2096"),s("br"),a._v("\n8443")])]),a._v(" "),s("p",[a._v("而我的9300不在这些支持端口中，导致dns解析失败，一直访问异常。\n"),s("strong",[a._v("后来将端口改为支持的2096后，问题解决，解析正常！泪目，捣鼓了2个小时")])]),a._v(" "),s("p",[s("a",{attrs:{href:"https://itlanyan.com/cloudflare-set-origin-port/",target:"_blank",rel:"noopener noreferrer"}},[a._v("cloudflare资料"),s("OutboundLink")],1)]),a._v(" "),s("h2",{attrs:{id:"总结"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#总结"}},[a._v("#")]),a._v(" 总结")]),a._v(" "),s("h2",{attrs:{id:"泛播-wildcard-broadcasting-与泛解析-wildcard-dns-的概念与区别"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#泛播-wildcard-broadcasting-与泛解析-wildcard-dns-的概念与区别"}},[a._v("#")]),a._v(" 泛播（Wildcard Broadcasting）与泛解析（Wildcard DNS）的概念与区别")]),a._v(" "),s("h3",{attrs:{id:"泛解析-wildcard-dns"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#泛解析-wildcard-dns"}},[a._v("#")]),a._v(" 泛解析（Wildcard DNS）")]),a._v(" "),s("h4",{attrs:{id:"概念"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#概念"}},[a._v("#")]),a._v(" 概念")]),a._v(" "),s("p",[a._v("泛解析是指在DNS服务器中使用通配符（通常是 "),s("code",[a._v("*")]),a._v("）配置，以便任何子域名请求都解析到同一个IP地址。例如，如果在DNS服务器中设置了 "),s("code",[a._v("*.example.com")]),a._v(" 指向 "),s("code",[a._v("192.0.2.1")]),a._v("，那么 "),s("code",[a._v("subdomain1.example.com")]),a._v("、"),s("code",[a._v("subdomain2.example.com")]),a._v(" 以及其他 "),s("code",[a._v("*.example.com")]),a._v(" 的子域名都会解析到 "),s("code",[a._v("192.0.2.1")]),a._v("。")]),a._v(" "),s("h4",{attrs:{id:"示例"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#示例"}},[a._v("#")]),a._v(" 示例")]),a._v(" "),s("p",[a._v("假设域名为 "),s("code",[a._v("example.com")]),a._v("，并设置了泛解析：\n"),s("code",[a._v("*.example.com -> 192.0.2.1")]),a._v("\n那么：")]),a._v(" "),s("ul",[s("li",[s("code",[a._v("www.example.com")]),a._v(" -> 192.0.2.1")]),a._v(" "),s("li",[s("code",[a._v("blog.example.com")]),a._v(" -> 192.0.2.1")]),a._v(" "),s("li",[s("code",[a._v("anything.example.com")]),a._v(" -> 192.0.2.1")])]),a._v(" "),s("h3",{attrs:{id:"泛播-wildcard-broadcasting"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#泛播-wildcard-broadcasting"}},[a._v("#")]),a._v(" 泛播（Wildcard Broadcasting）")]),a._v(" "),s("h4",{attrs:{id:"概念-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#概念-2"}},[a._v("#")]),a._v(" 概念")]),a._v(" "),s("p",[a._v("泛播是网络层级的一个概念，通常用于广播网络数据包。它是指在一个网络中将数据包发送到所有可能的目的地址。IP广播包括向整个子网发送数据包（广播地址），例如向 "),s("code",[a._v("255.255.255.255")]),a._v(" 发送数据包，这会在整个本地网络中进行广播。")]),a._v(" "),s("h4",{attrs:{id:"示例-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#示例-2"}},[a._v("#")]),a._v(" 示例")]),a._v(" "),s("p",[a._v("在局域网中进行广播：")]),a._v(" "),s("ul",[s("li",[a._v("广播地址："),s("code",[a._v("192.168.1.255")])]),a._v(" "),s("li",[a._v("发送数据包到 "),s("code",[a._v("192.168.1.255")]),a._v("，该子网内的所有设备都会收到这个数据包。")])]),a._v(" "),s("h3",{attrs:{id:"区别"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#区别"}},[a._v("#")]),a._v(" 区别")]),a._v(" "),s("table",[s("thead",[s("tr",[s("th",[a._v("特性")]),a._v(" "),s("th",[a._v("泛解析（Wildcard DNS）")]),a._v(" "),s("th",[a._v("泛播（Wildcard Broadcasting）")])])]),a._v(" "),s("tbody",[s("tr",[s("td",[a._v("应用层级")]),a._v(" "),s("td",[a._v("DNS层级")]),a._v(" "),s("td",[a._v("网络层级")])]),a._v(" "),s("tr",[s("td",[a._v("主要功能")]),a._v(" "),s("td",[a._v("将所有子域名指向一个特定的IP地址")]),a._v(" "),s("td",[a._v("将数据包发送到网络中的所有设备")])]),a._v(" "),s("tr",[s("td",[a._v("实现方式")]),a._v(" "),s("td",[a._v("通过DNS记录配置")]),a._v(" "),s("td",[a._v("通过网络协议（如IP广播）实现")])]),a._v(" "),s("tr",[s("td",[a._v("典型使用场景")]),a._v(" "),s("td",[a._v("简化子域名管理，确保所有子域名都能正确解析")]),a._v(" "),s("td",[a._v("广播网络消息，如局域网中的ARP请求")])]),a._v(" "),s("tr",[s("td",[a._v("配置示例")]),a._v(" "),s("td",[s("code",[a._v("*.example.com -> 192.0.2.1")])]),a._v(" "),s("td",[s("code",[a._v("192.168.1.255")])])]),a._v(" "),s("tr",[s("td",[a._v("常见工具")]),a._v(" "),s("td",[a._v("DNS服务器（如BIND, Cloudflare）")]),a._v(" "),s("td",[a._v("网络设备，操作系统的网络堆栈")])]),a._v(" "),s("tr",[s("td",[a._v("使用环境")]),a._v(" "),s("td",[a._v("互联网或局域网中的域名解析")]),a._v(" "),s("td",[a._v("局域网中的数据包传输")])])])]),a._v(" "),s("h3",{attrs:{id:"总结-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#总结-2"}},[a._v("#")]),a._v(" 总结")]),a._v(" "),s("p",[a._v("泛解析和泛播虽然名称相似，但它们适用于不同的技术领域和场景。泛解析主要用于DNS域名解析，帮助将大量子域名指向同一IP地址；而泛播用于网络通信，将数据包发送到网络中的所有设备。")])])}),[],!1,null,null,null);s.default=v.exports}}]);