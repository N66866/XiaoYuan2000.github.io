(window.webpackJsonp=window.webpackJsonp||[]).push([[26],{307:function(a,t,r){"use strict";r.r(t);var n=r(14),e=Object(n.a)({},(function(){var a=this,t=a._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[t("h1",{attrs:{id:"设备断网排查"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#设备断网排查"}},[a._v("#")]),a._v(" 设备断网排查")]),a._v(" "),t("h2",{attrs:{id:"问题描述"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#问题描述"}},[a._v("#")]),a._v(" 问题描述")]),a._v(" "),t("p",[a._v("设备名：xface\n设备与服务器之间网络不通：放置一段时间后，xface设备与服务器之间互相测试网络连通都失败。")]),a._v(" "),t("ul",[t("li",[a._v("本机和局域网内其他设备连接正常，xface和局域网未连接过的服务器连接正常，连接过的连接失败（推测ARP问题）。")]),a._v(" "),t("li",[a._v("xface与网关连接正常")]),a._v(" "),t("li",[a._v("使用其他服务器（同网段）测试与本机的连接一切正常（ping和http访问接口）")]),a._v(" "),t("li",[a._v("使用其他服务器（同网段且未连接过的服务器）测试与xface设备的连接正常")]),a._v(" "),t("li",[a._v("使用其他服务器（同网段且连接过的服务器）测试与xface设备的连接不正常")]),a._v(" "),t("li",[a._v("使用其他服务器（不同网段）测试与本机的连接一切正常（ping和http访问接口）")]),a._v(" "),t("li",[a._v("使用其他服务器（不同网段且连接过的服务器）测试与xface设备的连接不正常（ping 1次后会重新请求初始化接口，然后无反应。再ping 第2次后，网络连通恢复正常）")]),a._v(" "),t("li",[a._v("使用其他服务器（不同网段且未连接过的服务器）测试与xface设备的连接正常\n解决方案：重新开关xface的DHCP后，连通恢复正常（xface的ip没有切换）")])]),a._v(" "),t("h2",{attrs:{id:"问题排查"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#问题排查"}},[a._v("#")]),a._v(" 问题排查")]),a._v(" "),t("h3",{attrs:{id:"wireshark-抓包"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#wireshark-抓包"}},[a._v("#")]),a._v(" wireshark 抓包")]),a._v(" "),t("p",[a._v("等到xface设备断网时，wireshark数据包如下图，在进行最后一次对xface服务器请求并挥手后，xface设备发起DHCP请求。然后xface设备就断网了\n"),t("img",{attrs:{src:"/cannot-understand/xface-01.png",alt:"pic"}}),a._v(" "),t("img",{attrs:{src:"/cannot-understand/xface-02.png",alt:"pic"}}),a._v("\n猜测是这边网络DHCP环境与设备不兼容\n抓包发现DHCP续期请求网关全部都是拒绝NAK，而设备被拒绝2次后就会释放IP，而局域网内其他设备是一直发，发到同意为止。")]),a._v(" "),t("hr"),a._v(" "),t("h3",{attrs:{id:"模拟dhcp过程"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#模拟dhcp过程"}},[a._v("#")]),a._v(" 模拟DHCP过程")]),a._v(" "),t("p",[t("a",{attrs:{href:"https://www.cnblogs.com/Wendy-r/p/12679241.html",target:"_blank",rel:"noopener noreferrer"}},[a._v("DHCP过程解读博客"),t("OutboundLink")],1)]),a._v(" "),t("ol",[t("li",[a._v("使用wireshark开始捕获")]),a._v(" "),t("li",[a._v("使用ipconfig /release “指定网卡名” 释放ip\n"),t("img",{attrs:{src:"/cannot-understand/xface-03.png",alt:"pic"}}),a._v("\n3.使用 ipconfig /renew “指定网卡名” 重新获取ip\n"),t("img",{attrs:{src:"/cannot-understand/xface-04.png",alt:"pic"}}),a._v("\n重新获取ip完成后，使用wireshark停止捕获并使用 bootp过滤包\n"),t("img",{attrs:{src:"/cannot-understand/xface-05.png",alt:"pic"}}),a._v("\nDHCP服务器没问题，可以支持获取ip\n"),t("img",{attrs:{src:"/cannot-understand/xface-06.png",alt:"pic"}}),a._v(" "),t("img",{attrs:{src:"/cannot-understand/xface-07.png",alt:"pic"}})])]),a._v(" "),t("h2",{attrs:{id:"解决方案"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#解决方案"}},[a._v("#")]),a._v(" 解决方案")]),a._v(" "),t("p",[a._v("进入路由器网关绑定静态DHCP和静态ARP后，问题解决。暂时测试3天无断网现象")])])}),[],!1,null,null,null);t.default=e.exports}}]);