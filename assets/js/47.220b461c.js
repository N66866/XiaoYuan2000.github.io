(window.webpackJsonp=window.webpackJsonp||[]).push([[47],{327:function(a,s,t){"use strict";t.r(s);var e=t(14),r=Object(e.a)({},(function(){var a=this,s=a._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[s("h1",{attrs:{id:"kafka"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#kafka"}},[a._v("#")]),a._v(" kafka")]),a._v(" "),s("h2",{attrs:{id:"下载安装"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#下载安装"}},[a._v("#")]),a._v(" 下载安装")]),a._v(" "),s("h3",{attrs:{id:"官网下载"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#官网下载"}},[a._v("#")]),a._v(" 官网下载")]),a._v(" "),s("p",[a._v("官网下载解压即可：https://kafka.apache.org/downloads")]),a._v(" "),s("h3",{attrs:{id:"非本机访问配置"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#非本机访问配置"}},[a._v("#")]),a._v(" 非本机访问配置")]),a._v(" "),s("p",[a._v("如果需要其他机器访问安装的kafka，则需要修改配置")]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("监听端口 允许外部ip访问\n# listeners=PLAINTEXT://:9092\nlisteners=PLAINTEXT://0.0.0.0:9092\n\n对外服务ip\n# advertised.listeners=PLAINTEXT://your.host.name:9092\nadvertised.listeners=PLAINTEXT://安装的机器ip:9092\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br"),s("span",{staticClass:"line-number"},[a._v("7")]),s("br")])]),s("h3",{attrs:{id:"docker下载"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#docker下载"}},[a._v("#")]),a._v(" docker下载")]),a._v(" "),s("p",[a._v("docker pull apache/kafka:[version]\n例如：")]),a._v(" "),s("div",{staticClass:"language-sh line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" pull apache/kafka:3.7.0 \n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("p",[a._v("注意：docker 需要代理才能拉镜像，可参考本网站的docker篇章")]),a._v(" "),s("h3",{attrs:{id:"docker外部机器连接不上"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#docker外部机器连接不上"}},[a._v("#")]),a._v(" docker外部机器连接不上")]),a._v(" "),s("p",[s("strong",[a._v("docker容器的kafka有三种配置启动方式")]),a._v("\n详情可看 docker文档：https://github.com/apache/kafka/blob/trunk/docker/examples/README.md")]),a._v(" "),s("ol",[s("li",[a._v("默认配置：外部连不上")]),a._v(" "),s("li",[a._v("文件输入：提供本地配置文件，替换掉docker中默认配置")])]),a._v(" "),s("div",{staticClass:"language-sh line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 进去kafka容器")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 进去容器配置文件 /etc/kafka/docker/server.properties 不能编辑是只读的，并且这个修改只针对该容器，而不是apache/kafka镜像。所以要将配置文件放在宿主机。")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("exec")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-it")]),a._v(" kafka-container-id /bin/bash\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 将配置文件复制出宿主机")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("cp")]),a._v(" kafka-container-id:/etc/kafka/docker/server.properties /opt/kafka/docker/\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 将配置编辑如下")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br"),s("span",{staticClass:"line-number"},[a._v("7")]),s("br")])]),s("p",[s("img",{attrs:{src:"/middleware/kafka-01.png",alt:"pic"}}),s("br"),a._v("\n修改完配置后，将配置挂载")]),a._v(" "),s("div",{staticClass:"language-sh line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# docker run --volume（或简称 -v） 是 Docker 命令中用于挂载卷（volume）的选项。卷是 Docker 用来持久化和共享数据的一种机制，可以在容器之间共享数据，或者将数据持久化到主机文件系统中。使用卷可以确保即使容器被删除，数据也不会丢失。")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 将刚才修改的配置挂载进 kafka 容器中，启动后外部可以连接")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" run "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--volume")]),a._v(" /opt/kafka/docker/:/mnt/shared/config "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-p")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("9092")]),a._v(":9092 apache/kafka:3.7.0\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br")])]),s("ol",{attrs:{start:"3"}},[s("li",[a._v("环境变量：")])]),a._v(" "),s("h2",{attrs:{id:"使用官方脚本"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#使用官方脚本"}},[a._v("#")]),a._v(" 使用官方脚本")]),a._v(" "),s("h3",{attrs:{id:"启动-退出"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#启动-退出"}},[a._v("#")]),a._v(" 启动/退出：")]),a._v(" "),s("div",{staticClass:"language-sh line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[a._v("// 使用zookeeper 启动\n"),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v(". zookeeper\n\t* 启动： "),s("span",{pre:!0,attrs:{class:"token variable"}},[s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")]),a._v("bin/zookeeper-server-start.sh "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-daemon")]),a._v(" config/zookeeper.properties"),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")])]),a._v("\n\t* 关闭： "),s("span",{pre:!0,attrs:{class:"token variable"}},[s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")]),a._v("bin/zookeeper-server-stop.sh "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-daemon")]),a._v(" config/zookeeper.properties"),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")])]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("2")]),a._v(". kafka\n\t* 启动： "),s("span",{pre:!0,attrs:{class:"token variable"}},[s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")]),a._v("bin/kafka-server-start.sh "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-daemon")]),a._v(" config/server.properties"),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")])]),a._v("\n\t* 关闭： "),s("span",{pre:!0,attrs:{class:"token variable"}},[s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")]),a._v("bin/kafka-server-stop.sh "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-daemon")]),a._v(" config/server.properties"),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")])]),a._v("\n\n// 使用 KRaft启动 （bin目录下）\n"),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v(". 生成集群id\n./kafka-storage.sh random-uuid "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 输出82vqfbdSTO2QzS_M0Su1Bw")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("2")]),a._v(". 配置元数据（集群下每台机器都要配置）\n./kafka-storage.sh "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("format")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-t")]),a._v(" 82vqfbdSTO2QzS_M0Su1Bw "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-c")]),a._v(" config/kraft/server.properties\n"),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("3")]),a._v(". 启动集群\n./kafka-server-start.sh "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-daemon")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),a._v("/config/kraft/server.properties "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 当全部节点都出现 Kafka Server started，集群启动成功")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("4")]),a._v(". 关闭集群\n./kafka-server-stop.sh "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-c")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),a._v("/config/kraft/server.properties\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br"),s("span",{staticClass:"line-number"},[a._v("7")]),s("br"),s("span",{staticClass:"line-number"},[a._v("8")]),s("br"),s("span",{staticClass:"line-number"},[a._v("9")]),s("br"),s("span",{staticClass:"line-number"},[a._v("10")]),s("br"),s("span",{staticClass:"line-number"},[a._v("11")]),s("br"),s("span",{staticClass:"line-number"},[a._v("12")]),s("br"),s("span",{staticClass:"line-number"},[a._v("13")]),s("br"),s("span",{staticClass:"line-number"},[a._v("14")]),s("br"),s("span",{staticClass:"line-number"},[a._v("15")]),s("br"),s("span",{staticClass:"line-number"},[a._v("16")]),s("br"),s("span",{staticClass:"line-number"},[a._v("17")]),s("br")])]),s("h3",{attrs:{id:"主题"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#主题"}},[a._v("#")]),a._v(" 主题")]),a._v(" "),s("p",[s("strong",[a._v("使用 bin/kafka-topics.sh 不传参可以查看帮助")])]),a._v(" "),s("p",[a._v("创建主题(topic)：")]),a._v(" "),s("div",{staticClass:"language-sh line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[a._v("\t* 新建一个名为"),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"Hello-Kafka"')]),a._v("的主题： "),s("span",{pre:!0,attrs:{class:"token variable"}},[s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")]),a._v("bin/kafka-topics.sh "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--create")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--zookeeper")]),a._v(" localhost:2181 --replication-factor "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--partitions")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--topic")]),a._v(" Hello-Kafka"),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")])]),a._v("\n\t* 新建一个名为"),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"hello"')]),a._v("的主题（简易版）: "),s("span",{pre:!0,attrs:{class:"token variable"}},[s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")]),a._v("bin/kafka-topics.sh "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--create")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--topic")]),a._v(" hello --bootstrap-server localhost:9092"),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")])]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br")])]),s("p",[a._v("删除主题(topic)：")]),a._v(" "),s("div",{staticClass:"language-sh line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[a._v("\t* 删除一个名为"),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"hello"')]),a._v("的主题（简易版）: "),s("span",{pre:!0,attrs:{class:"token variable"}},[s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")]),a._v("bin/kafka-topics.sh "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--delete")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--topic")]),a._v("  hello --bootstrap-server localhost:9092"),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")])]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("p",[a._v("查看主题(topic):")]),a._v(" "),s("div",{staticClass:"language-sh line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[a._v("\t* 查看主题 zookeeper： "),s("span",{pre:!0,attrs:{class:"token variable"}},[s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")]),a._v("bin/kafka-topics.sh "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--list")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--zookeeper")]),a._v(" localhost:2181"),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")])]),a._v("\n\t* 查看主题： "),s("span",{pre:!0,attrs:{class:"token variable"}},[s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")]),a._v("bin/kafka-topics.sh "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--list")]),a._v(" --bootstrap-server localhost:9092"),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")])]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br")])]),s("p",[a._v("显示主题详细(topic):")]),a._v(" "),s("div",{staticClass:"language-sh line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[a._v("\t* "),s("span",{pre:!0,attrs:{class:"token variable"}},[s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")]),a._v("bin/kafka-topics.sh "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--describe")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--topic")]),a._v(" hello --bootstrap-server localhost:9092"),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")])]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("p",[a._v("改变主题(topic):")]),a._v(" "),s("div",{staticClass:"language-sh line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[a._v("\t* 修改分区数： "),s("span",{pre:!0,attrs:{class:"token variable"}},[s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")]),a._v("bin/kafka-topics.sh "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--alert")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--topic")]),a._v(" hello  "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--partition")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("5")]),a._v(" --bootstrap-server localhost:9092"),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")])]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("h3",{attrs:{id:"收发消息"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#收发消息"}},[a._v("#")]),a._v(" 收发消息")]),a._v(" "),s("p",[s("strong",[a._v("使用bin/kafka-console-producer.sh 和 bin/kafka-console-consumer.sh")])]),a._v(" "),s("div",{staticClass:"language-sh line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 发送消息")]),a._v("\n\t* 向"),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"Hello-Kafka"')]),a._v("发送消息： bin/kafka-console-producer.sh "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--topic")]),a._v(" Hello-Kafka --bootstrap-server localhost:9092\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br")])]),s("div",{staticClass:"language-sh line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 监听主题")]),a._v("\n\t* 监听"),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"Hello-Kafka"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),a._v(" bin/kafka-console-consumer.sh "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--topic")]),a._v(" Hello-Kafka --bootstrap-server localhost:9092 --from-beginning "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#从头开始读")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br")])]),s("h3",{attrs:{id:"重置偏移量"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#重置偏移量"}},[a._v("#")]),a._v(" 重置偏移量")]),a._v(" "),s("div",{staticClass:"language-sh line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[a._v("\t* offset重置到头 bin/kafka-consumer-grous.sh --bootstrap-server "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("127.0")]),a._v(".0.1:9092 "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--group")]),a._v(" 消费者组 "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--topic")]),a._v(" 主题 --reset-offsets --to-earliest "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--excute")]),a._v("\n\t* offset重置到尾 bin/kafka-consumer-grous.sh --bootstrap-server "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("127.0")]),a._v(".0.1:9092 "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--group")]),a._v(" 消费者组 "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--topic")]),a._v(" 主题 --reset-offsets --to-latest "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--excute")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br")])]),s("h2",{attrs:{id:"spring集成kafka"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#spring集成kafka"}},[a._v("#")]),a._v(" spring集成kafka")]),a._v(" "),s("p",[a._v("请看本站的另一个spring栏目："),s("RouterLink",{attrs:{to:"/middleware/spring-kafka.html#服务器安装"}},[a._v("看这里")])],1),a._v(" "),s("h2",{attrs:{id:"kafka-概念"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#kafka-概念"}},[a._v("#")]),a._v(" kafka 概念")]),a._v(" "),s("h3",{attrs:{id:"副本replica"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#副本replica"}},[a._v("#")]),a._v(" 副本Replica")]),a._v(" "),s("p",[a._v("在创建主题时，"),s("strong",[s("code",[a._v("--replication-factor")]),a._v(" 就是指定副本数量 最小为1 最大不超过节点数量")]),s("br"),a._v("\n只有一个副本时，就只有主副本即主节点。 多个副本时，读写也是操作主节点，从副本（从节点）只用于备份主节点数据。"),s("br"),a._v("\n当主节点挂掉时，从节点顶上成为主节点。")]),a._v(" "),s("div",{staticClass:"language-sh line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[a._v("\t* 新建一个名为"),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"Hello-Kafka"')]),a._v("的主题： "),s("span",{pre:!0,attrs:{class:"token variable"}},[s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")]),a._v("bin/kafka-topics.sh "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--create")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--zookeeper")]),a._v(" localhost:2181 --replication-factor "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--partitions")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--topic")]),a._v(" Hello-Kafka"),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")])]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("h3",{attrs:{id:"多副本架构"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#多副本架构"}},[a._v("#")]),a._v(" 多副本架构")]),a._v(" "),s("h4",{attrs:{id:"基本概念"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#基本概念"}},[a._v("#")]),a._v(" 基本概念")]),a._v(" "),s("p",[a._v("主题（Topic）：Kafka中的消息是按主题组织的，每个主题可以看作是一类消息的集合。"),s("br"),a._v("\n分区（Partition）：每个主题可以分为多个分区，分区是消息存储和读取的基本单位。分区使得消息可以并行处理。"),s("br"),a._v("\n副本（Replica）：每个分区可以有多个副本，每个副本存储相同的数据。副本是Kafka高可用性的基础。"),s("br"),a._v("\n领导者副本（Leader Replica）：每个分区有一个领导者副本，负责处理所有的读写请求。"),s("br"),a._v("\n跟随者副本（Follower Replica）：其他副本称为跟随者副本，它们从领导者副本中复制数据，确保数据的一致性。")]),a._v(" "),s("h4",{attrs:{id:"_1-isr-in-sync-replicas"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-isr-in-sync-replicas"}},[a._v("#")]),a._v(" 1. ISR (In-Sync Replicas)")]),a._v(" "),s("p",[a._v("ISR（In-Sync Replicas）指的是一个分区中与Leader保持同步的副本集合。ISR确保数据的一致性和可靠性。当一个分区的Leader接收到一条新的消息时，这条消息会被同步到ISR中的所有副本。只有在所有ISR副本都确认接收到这条消息后，消息才会被认为是已提交的。ISR集合中的副本都可以在Leader失效时被选举为新的Leader。")]),a._v(" "),s("h4",{attrs:{id:"_2-leo-log-end-offset"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-leo-log-end-offset"}},[a._v("#")]),a._v(" 2. LEO (Log End Offset)")]),a._v(" "),s("p",[a._v("LEO（Log End Offset）是每个副本的一个重要属性，它表示这个副本日志中的下一条消息的Offset。换句话说，LEO是日志中当前最新消息的Offset + 1。LEO用于跟踪副本日志的末尾位置，并帮助判断副本之间的同步状态。")]),a._v(" "),s("h4",{attrs:{id:"_3-hw-high-watermark"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-hw-high-watermark"}},[a._v("#")]),a._v(" 3. HW (High Watermark)")]),a._v(" "),s("p",[a._v("HW（High Watermark）是Leader副本的一个属性，它表示所有ISR副本都已确认的最新消息的Offset。消费者只能读取到HW之前的消息，这确保了消费者只看到已经完全同步并确认的消息。HW的存在确保了数据的一致性，即消费者不会读取到可能丢失或未同步完成的消息。")]),a._v(" "),s("p",[a._v("这些概念的关系\nLeader和Follower：每个分区有一个Leader和多个Follower。Leader处理所有的读写请求，Follower从Leader同步数据。"),s("br"),a._v("\nISR集合：ISR集合包括Leader和所有与Leader保持同步的Follower。只有在ISR中的副本才能被选为新的Leader。"),s("br"),a._v("\nLEO：LEO表示副本日志的末尾位置。Leader和Follower都有自己的LEO。Leader的LEO通常是最新的，而Follower的LEO会落后一些，直到它们完成同步。"),s("br"),a._v("\nHW：HW由Leader管理，表示所有ISR副本都已确认的消息的Offset。消费者只能读取到HW之前的消息。")]),a._v(" "),s("p",[a._v("举例说明"),s("br"),a._v("\n假设有一个分区P，它有一个Leader L和两个Follower F1和F2。")]),a._v(" "),s("p",[a._v("初始状态下，L、F1和F2都是ISR的一部分，且它们的LEO相同，假设是10。"),s("br"),a._v("\n当Producer写入一条新消息M时，消息M的Offset是10，L的LEO更新为11。"),s("br"),a._v("\nL将消息M同步到F1和F2，F1和F2的LEO分别更新为11。"),s("br"),a._v("\n当L确认F1和F2都已同步消息M后，L更新HW为11。"),s("br"),a._v("\n消费者读取消息时，只能读取到Offset 11之前的消息。")]),a._v(" "),s("h4",{attrs:{id:"多副本架构-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#多副本架构-2"}},[a._v("#")]),a._v(" 多副本架构")]),a._v(" "),s("p",[a._v("Kafka的多副本架构主要包括以下几个方面：")]),a._v(" "),s("p",[a._v("副本分布：每个分区的副本分布在不同的Kafka Broker上，以实现容错和高可用性。如果一个Broker故障，分区的副本仍然可以在其他Broker上访问。")]),a._v(" "),s("p",[a._v("数据复制：领导者副本负责处理写入请求，并将数据复制到所有跟随者副本。复制过程是异步的，但可以通过配置确保数据的一致性（如设置acks=all）。")]),a._v(" "),s("p",[a._v("故障恢复：当领导者副本失效时，Kafka会自动选举一个新的领导者副本。选举过程确保最小化数据丢失和服务中断。")]),a._v(" "),s("p",[a._v("ISR（In-Sync Replicas）：ISR是指与领导者副本保持同步的副本集合。只有在ISR中的副本才能被选举为新的领导者副本，以确保数据的一致性和可靠性。")]),a._v(" "),s("p",[a._v("分区和副本管理：Kafka使用ZooKeeper来管理分区的元数据和副本状态。ZooKeeper帮助协调副本的分布和领导者的选举。")]),a._v(" "),s("h4",{attrs:{id:"优势"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#优势"}},[a._v("#")]),a._v(" 优势")]),a._v(" "),s("p",[a._v("高可用性：通过多副本机制，即使某个Broker失效，数据仍然可以通过其他副本访问。\n数据持久性：多副本确保数据不会因单点故障而丢失。\n负载均衡：多个副本可以分散在不同的Broker上，均衡负载，提高整体性能。")]),a._v(" "),s("h3",{attrs:{id:"kafka事件数据的储存"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#kafka事件数据的储存"}},[a._v("#")]),a._v(" kafka事件数据的储存")]),a._v(" "),s("h4",{attrs:{id:"数据文件保存"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#数据文件保存"}},[a._v("#")]),a._v(" 数据文件保存")]),a._v(" "),s("p",[a._v("查看kafka的配置文件： server.properties 之 log.dirs\nkafka的所有事件都是以日志文件的方式来保存的。格式 topicId-partitionId\n例如 : test-topic-0\n000000000000000000000000.index 消息索引文件\n000000000000000000000000.log 消息数据文件\n000000000000000000000000.timeindex 消息的时间戳索引文件\n000000000000000000000001.snapshot 快照文件，生产者发生故障或者重启时能够恢复并继续之前的操作\nleader-epoch-checkpoint 记录每个分区当前领导者的epoch以及领导者开始写入消息时的起始偏移量\npartition.metadata 存储关于特定分区的元数据信息")]),a._v(" "),s("h4",{attrs:{id:"consumer-offsets"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#consumer-offsets"}},[a._v("#")]),a._v(" "),s("code",[a._v("consumer_offsets")])]),a._v(" "),s("ol",[s("li",[s("p",[a._v("作用\n"),s("code",[a._v("__consumer_offsets")]),a._v("是一个特殊的内部主题，用于存储消费者组的偏移量信息。主要作用是记录每个消费者组中消费者的偏移量，确保消费者发生故障或重启时能够从上次提交的偏移量继续消费，避免数据丢失或重复消费。")])]),a._v(" "),s("li",[s("p",[a._v("结构和分区\n分区数："),s("code",[a._v("__consumer_offsets")]),a._v(" 主题默认有 50 个分区。这是为了支持高并发和大规模的消费者组。\n键和值：每条记录的键是一个由消费者组 ID、主题和分区组成的复合键；值是消费者的偏移量和元数据（如提交的时间戳）。")])]),a._v(" "),s("li",[s("p",[a._v("记录格式\n键（Key）：\n消费者组 ID：消费者组的唯一标识符。\n主题：消费者正在消费的主题。\n分区：消费者正在消费的主题分区。")])])]),a._v(" "),s("p",[a._v("值（Value）：\n偏移量：消费者在该分区上提交的最新偏移量。\n元数据：一些额外的信息，如提交的时间戳。")]),a._v(" "),s("ol",{attrs:{start:"4"}},[s("li",[a._v("示例\n假设有一个消费者组 ID 为 group1，正在消费主题 topic1 的分区 partition0，当前偏移量为 100。在 "),s("code",[a._v("__consumer_offsets")]),a._v("主题中，可能存储的记录如下：")])]),a._v(" "),s("p",[a._v("键：\n消费者组 ID：group1\n主题：topic1\n分区：partition0")]),a._v(" "),s("p",[a._v("值：\n偏移量：100\n元数据：如时间戳 1620000000000")]),a._v(" "),s("ol",{attrs:{start:"5"}},[s("li",[a._v("读取和监控 "),s("code",[a._v("__consumer_offsets")]),a._v("\n可以使用 Kafka 提供的工具来查看和监控 "),s("code",[a._v("__consumer_offsets")]),a._v(" 主题的数据。例如，可以使用 kafka-consumer-groups.sh 工具来查看消费者组的偏移量信息。")])]),a._v(" "),s("div",{staticClass:"language-sh line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[a._v("bin/kafka-consumer-groups.sh --bootstrap-server localhost:9092 "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--group")]),a._v(" group1 "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--describe")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# group topic       partition  current-offset          log-end-offset     lag ")]),a._v("\n group1 test-topic  "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),a._v("          "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("10")]),a._v("                          "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("15")]),a._v("              "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("5")]),a._v("\n 消费组  主题        分区号     当前分区消费者offset   当前分区生产者offset   可读取消息数\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br")])]),s("p",[a._v("这个命令将显示消费者组 group1 在各个分区上的偏移量、日志末尾偏移量以及滞后量。")]),a._v(" "),s("ol",{attrs:{start:"6"}},[s("li",[s("p",[a._v("内部机制\n当消费者提交偏移量时，Kafka 会将该信息写入到 "),s("code",[a._v("__consumer_offsets")]),a._v(" 主题中。提交过程如下："),s("br"),a._v("\n消费者消费消息：消费者从主题的某个分区消费消息。\n提交偏移量：消费者定期提交消费到的偏移量到 "),s("code",[a._v("__consumer_offsets")]),a._v(" 主题。\n写入日志：提交的偏移量作为一条记录写入 "),s("code",[a._v("__consumer_offsets")]),a._v(" 主题的相应分区。\n从偏移量恢复：如果消费者发生故障或重新启动，它将从 "),s("code",[a._v("__consumer_offsets")]),a._v(" 主题中读取最后一次提交的偏移量，继续消费。")])]),a._v(" "),s("li",[s("p",[a._v("数据保留\n"),s("code",[a._v("__consumer_offsets")]),a._v(" 主题的数据保留策略通常设置为较长的时间，以确保可以在较长时间内恢复消费者的状态。可以通过以下参数配置：\noffsets.retention.minutes：指定偏移量保留的时间，默认是 7 天。\noffsets.retention.check.interval.ms：指定检查过期偏移量的间隔时间。\n配置示例\n在 Kafka 配置文件（server.properties）中，可以配置这些参数：")])])]),a._v(" "),s("div",{staticClass:"language-properties line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-properties"}},[s("code",[s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("offsets.retention.minutes")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("10080  # 7 天")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("offsets.retention.check.interval.ms")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("600000  # 10 分钟")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br")])]),s("ol",{attrs:{start:"8"}},[s("li",[a._v("总结\n"),s("code",[a._v("__consumer_offsets")]),a._v(" 主题是 Kafka 用于管理消费者组偏移量的核心组件。它确保消费者能够从故障中恢复，并避免数据丢失或重复消费。通过理解其工作机制和配置选项，可以更好地管理和监控 Kafka 消费者组的行为。")])]),a._v(" "),s("h2",{attrs:{id:"kafka集群搭建"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#kafka集群搭建"}},[a._v("#")]),a._v(" kafka集群搭建")]),a._v(" "),s("h3",{attrs:{id:"zookeeper"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#zookeeper"}},[a._v("#")]),a._v(" zookeeper")]),a._v(" "),s("h4",{attrs:{id:"配置非本机访问配置"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#配置非本机访问配置"}},[a._v("#")]),a._v(" 配置非本机访问配置")]),a._v(" "),s("p",[a._v("如果需要其他机器访问安装的kafka，则需要修改配置")]),a._v(" "),s("div",{staticClass:"language-properties line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-properties"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# The id of the broker. This must be set to a unique integer for each broker.  broker id")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("broker.id")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("1")]),a._v("\n\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 监听端口 允许外部ip访问")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# listeners=PLAINTEXT://:9092")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("listeners")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("PLAINTEXT://0.0.0.0:9092")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#对外服务ip")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# advertised.listeners=PLAINTEXT://your.host.name:9092")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("advertised.listeners")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("PLAINTEXT://安装的机器ip:9092")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#日志文件目录")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("log.dirs")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("/tmp/kafka-logs-01")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br"),s("span",{staticClass:"line-number"},[a._v("7")]),s("br"),s("span",{staticClass:"line-number"},[a._v("8")]),s("br"),s("span",{staticClass:"line-number"},[a._v("9")]),s("br"),s("span",{staticClass:"line-number"},[a._v("10")]),s("br"),s("span",{staticClass:"line-number"},[a._v("11")]),s("br"),s("span",{staticClass:"line-number"},[a._v("12")]),s("br"),s("span",{staticClass:"line-number"},[a._v("13")]),s("br"),s("span",{staticClass:"line-number"},[a._v("14")]),s("br")])]),s("h4",{attrs:{id:"启动zookeeper"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#启动zookeeper"}},[a._v("#")]),a._v(" 启动zookeeper")]),a._v(" "),s("div",{staticClass:"language-sh line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[a._v("/ 使用zookeeper 启动\n"),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v(". zookeeper\n\t* 启动： "),s("span",{pre:!0,attrs:{class:"token variable"}},[s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")]),a._v("bin/zookeeper-server-start.sh "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-daemon")]),a._v(" config/zookeeper.properties"),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")])]),a._v("\n\t* 关闭： "),s("span",{pre:!0,attrs:{class:"token variable"}},[s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")]),a._v("bin/zookeeper-server-stop.sh "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-daemon")]),a._v(" config/zookeeper.properties"),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")])]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("2")]),a._v(". kafka\n\t* 启动： "),s("span",{pre:!0,attrs:{class:"token variable"}},[s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")]),a._v("bin/kafka-server-start.sh "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-daemon")]),a._v(" config/server.properties"),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")])]),a._v("\n\t* 关闭： "),s("span",{pre:!0,attrs:{class:"token variable"}},[s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")]),a._v("bin/kafka-server-stop.sh "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-daemon")]),a._v(" config/server.properties"),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")])]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br"),s("span",{staticClass:"line-number"},[a._v("7")]),s("br")])]),s("h3",{attrs:{id:"kraft"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#kraft"}},[a._v("#")]),a._v(" Kraft")]),a._v(" "),s("p",[a._v("zookeeper 使用普通方式搭建，那KRaft就用docker吧。\n先将容器的配置文件复制一份，参考"),s("a",{attrs:{href:"#docker%E5%A4%96%E9%83%A8%E6%9C%BA%E5%99%A8%E8%BF%9E%E6%8E%A5%E4%B8%8D%E4%B8%8A"}},[a._v("这里")])]),a._v(" "),s("div",{staticClass:"language-sh line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[a._v("drwxr-xr-x "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("2")]),a._v(" root root   "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("31")]),a._v(" Jul "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("30")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("23")]),a._v(":04 kafka01\ndrwxr-xr-x "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("2")]),a._v(" root root   "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("31")]),a._v(" Jul "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("30")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("23")]),a._v(":05 kafka02\ndrwxr-xr-x "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("2")]),a._v(" root root   "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("31")]),a._v(" Jul "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("30")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("23")]),a._v(":05 kafka03\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br")])]),s("p",[a._v("主要改配置如下")]),a._v(" "),s("div",{staticClass:"language-properties line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-properties"}},[s("code",[s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("node.id")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("1")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("process.roles")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("broker,controller")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("listeners")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("PLAINTEXT://kafka-01:9092,CONTROLLER://kafka-01:9093")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("controller.quorum.voters")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("1@kafka-01:9093,2@kafka-02:9093,3@kafka-03:9093")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("log.dirs")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("/var/lib/kafka/data")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("metadata.log.dir")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("/var/lib/kafka/meta")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("node.id")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("2")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("process.roles")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("broker,controller")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("listeners")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("PLAINTEXT://kafka-02:9092,CONTROLLER://kafka-02:9093")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("controller.quorum.voters")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("1@kafka-01:9093,2@kafka-02:9093,3@kafka-03:9093")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("log.dirs")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("/var/lib/kafka/data")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("metadata.log.dir")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("/var/lib/kafka/meta")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("node.id")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("3")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("process.roles")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("broker,controller")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("listeners")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("PLAINTEXT://kafka-03:9092,CONTROLLER://kafka-03:9093")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("controller.quorum.voters")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("1@kafka-01:9093,2@kafka-02:9093,3@kafka-03:9093")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("log.dirs")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("/var/lib/kafka/data")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("metadata.log.dir")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("/var/lib/kafka/meta")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br"),s("span",{staticClass:"line-number"},[a._v("7")]),s("br"),s("span",{staticClass:"line-number"},[a._v("8")]),s("br"),s("span",{staticClass:"line-number"},[a._v("9")]),s("br"),s("span",{staticClass:"line-number"},[a._v("10")]),s("br"),s("span",{staticClass:"line-number"},[a._v("11")]),s("br"),s("span",{staticClass:"line-number"},[a._v("12")]),s("br"),s("span",{staticClass:"line-number"},[a._v("13")]),s("br"),s("span",{staticClass:"line-number"},[a._v("14")]),s("br"),s("span",{staticClass:"line-number"},[a._v("15")]),s("br"),s("span",{staticClass:"line-number"},[a._v("16")]),s("br"),s("span",{staticClass:"line-number"},[a._v("17")]),s("br"),s("span",{staticClass:"line-number"},[a._v("18")]),s("br"),s("span",{staticClass:"line-number"},[a._v("19")]),s("br"),s("span",{staticClass:"line-number"},[a._v("20")]),s("br")])]),s("p",[a._v("然后启动容器")]),a._v(" "),s("div",{staticClass:"language-sh line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 创建网络")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" network create kafka-network\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 启动kafka 挂载配置文件")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" run "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-d")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--name")]),a._v(" kafka-01 "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--hostname")]),a._v(" kafka-01 "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--network")]),a._v(" kafka-network "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-p")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("9092")]),a._v(":9092 "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-p9093:9093")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--volume")]),a._v(" /opt/kafka/docker/kafka01/:/mnt/shared/config apache/kafka:3.7.0\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" run "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-d")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--name")]),a._v(" kafka-02 "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--hostname")]),a._v(" kafka-02 "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--network")]),a._v(" kafka-network "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-p")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("9094")]),a._v(":9092 "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-p9095:9093")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--volume")]),a._v(" /opt/kafka/docker/kafka02/:/mnt/shared/config apache/kafka:3.7.0\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" run "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-d")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--name")]),a._v(" kafka-03 "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--hostname")]),a._v(" kafka-03 "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--network")]),a._v(" kafka-network "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-p")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("9096")]),a._v(":9092 "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-p9097:9093")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--volume")]),a._v(" /opt/kafka/docker/kafka03/:/mnt/shared/config apache/kafka:3.7.0\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 然后查看网络")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" network inspect kafka-network\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 输出")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n        "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"Name"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"kafka-network"')]),a._v(",\n        "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"Id"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"f50de029ae30cb0d0603eb148663f3df92c6c0a03f1a911523ea94740fb9b33b"')]),a._v(",\n        "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"Created"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"2024-07-30T22:31:46.343318515+08:00"')]),a._v(",\n        "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"Scope"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"local"')]),a._v(",\n        "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"Driver"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"bridge"')]),a._v(",\n        "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"EnableIPv6"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),a._v(" false,\n        "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"IPAM"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n            "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"Driver"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"default"')]),a._v(",\n            "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"Options"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v(",\n            "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"Config"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("\n                "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n                    "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"Subnet"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"172.18.0.0/16"')]),a._v(",\n                    "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"Gateway"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"172.18.0.1"')]),a._v("\n                "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n            "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v(",\n        "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"Internal"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),a._v(" false,\n        "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"Attachable"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),a._v(" false,\n        "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"Ingress"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),a._v(" false,\n        "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"ConfigFrom"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n            "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"Network"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('""')]),a._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v(",\n        "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"ConfigOnly"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),a._v(" false,\n        "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"Containers"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n            "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"6b77aad291275004b6dd17fe1c0e492996f3dd21751070faee25634c8be8d5e7"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n                "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"Name"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"kafka-01"')]),a._v(",\n                "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"EndpointID"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"3982d469af589fd3eae769d55e7f2c72a09433dcd4ecfdcbf29acc7be7af5819"')]),a._v(",\n                "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"MacAddress"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"02:42:ac:12:00:02"')]),a._v(",\n                "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"IPv4Address"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"172.18.0.2/16"')]),a._v(",\n                "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"IPv6Address"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('""')]),a._v("\n            "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v(",\n            "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"86a729a8011075345e44d84e5276858ebeb7c45b855df74f649e6608e2a0ff29"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n                "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"Name"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"kafka-02"')]),a._v(",\n                "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"EndpointID"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"d5bd650d88730f22f89bff513ab44a6d116e4fce4793e0800a1f8f5c45a5f1ef"')]),a._v(",\n                "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"MacAddress"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"02:42:ac:12:00:03"')]),a._v(",\n                "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"IPv4Address"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"172.18.0.3/16"')]),a._v(",\n                "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"IPv6Address"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('""')]),a._v("\n            "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v(",\n            "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"f894a3511b1756dff1fd05a883df8ca79fe53693ed9c1c8d908b7085ecf56d87"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n                "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"Name"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"kafka-03"')]),a._v(",\n                "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"EndpointID"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"c3d2314b241696505632ca3d6a7bddf5dd08ecf978eea2c0406dba99cd525c3b"')]),a._v(",\n                "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"MacAddress"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"02:42:ac:12:00:04"')]),a._v(",\n                "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"IPv4Address"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"172.18.0.4/16"')]),a._v(",\n                "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"IPv6Address"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('""')]),a._v("\n            "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v(",\n        "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"Options"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v(",\n        "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"Labels"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br"),s("span",{staticClass:"line-number"},[a._v("7")]),s("br"),s("span",{staticClass:"line-number"},[a._v("8")]),s("br"),s("span",{staticClass:"line-number"},[a._v("9")]),s("br"),s("span",{staticClass:"line-number"},[a._v("10")]),s("br"),s("span",{staticClass:"line-number"},[a._v("11")]),s("br"),s("span",{staticClass:"line-number"},[a._v("12")]),s("br"),s("span",{staticClass:"line-number"},[a._v("13")]),s("br"),s("span",{staticClass:"line-number"},[a._v("14")]),s("br"),s("span",{staticClass:"line-number"},[a._v("15")]),s("br"),s("span",{staticClass:"line-number"},[a._v("16")]),s("br"),s("span",{staticClass:"line-number"},[a._v("17")]),s("br"),s("span",{staticClass:"line-number"},[a._v("18")]),s("br"),s("span",{staticClass:"line-number"},[a._v("19")]),s("br"),s("span",{staticClass:"line-number"},[a._v("20")]),s("br"),s("span",{staticClass:"line-number"},[a._v("21")]),s("br"),s("span",{staticClass:"line-number"},[a._v("22")]),s("br"),s("span",{staticClass:"line-number"},[a._v("23")]),s("br"),s("span",{staticClass:"line-number"},[a._v("24")]),s("br"),s("span",{staticClass:"line-number"},[a._v("25")]),s("br"),s("span",{staticClass:"line-number"},[a._v("26")]),s("br"),s("span",{staticClass:"line-number"},[a._v("27")]),s("br"),s("span",{staticClass:"line-number"},[a._v("28")]),s("br"),s("span",{staticClass:"line-number"},[a._v("29")]),s("br"),s("span",{staticClass:"line-number"},[a._v("30")]),s("br"),s("span",{staticClass:"line-number"},[a._v("31")]),s("br"),s("span",{staticClass:"line-number"},[a._v("32")]),s("br"),s("span",{staticClass:"line-number"},[a._v("33")]),s("br"),s("span",{staticClass:"line-number"},[a._v("34")]),s("br"),s("span",{staticClass:"line-number"},[a._v("35")]),s("br"),s("span",{staticClass:"line-number"},[a._v("36")]),s("br"),s("span",{staticClass:"line-number"},[a._v("37")]),s("br"),s("span",{staticClass:"line-number"},[a._v("38")]),s("br"),s("span",{staticClass:"line-number"},[a._v("39")]),s("br"),s("span",{staticClass:"line-number"},[a._v("40")]),s("br"),s("span",{staticClass:"line-number"},[a._v("41")]),s("br"),s("span",{staticClass:"line-number"},[a._v("42")]),s("br"),s("span",{staticClass:"line-number"},[a._v("43")]),s("br"),s("span",{staticClass:"line-number"},[a._v("44")]),s("br"),s("span",{staticClass:"line-number"},[a._v("45")]),s("br"),s("span",{staticClass:"line-number"},[a._v("46")]),s("br"),s("span",{staticClass:"line-number"},[a._v("47")]),s("br"),s("span",{staticClass:"line-number"},[a._v("48")]),s("br"),s("span",{staticClass:"line-number"},[a._v("49")]),s("br"),s("span",{staticClass:"line-number"},[a._v("50")]),s("br"),s("span",{staticClass:"line-number"},[a._v("51")]),s("br"),s("span",{staticClass:"line-number"},[a._v("52")]),s("br"),s("span",{staticClass:"line-number"},[a._v("53")]),s("br"),s("span",{staticClass:"line-number"},[a._v("54")]),s("br"),s("span",{staticClass:"line-number"},[a._v("55")]),s("br"),s("span",{staticClass:"line-number"},[a._v("56")]),s("br"),s("span",{staticClass:"line-number"},[a._v("57")]),s("br"),s("span",{staticClass:"line-number"},[a._v("58")]),s("br"),s("span",{staticClass:"line-number"},[a._v("59")]),s("br"),s("span",{staticClass:"line-number"},[a._v("60")]),s("br"),s("span",{staticClass:"line-number"},[a._v("61")]),s("br")])]),s("p",[a._v("这种情况是正常启动，集群搭建完毕")]),a._v(" "),s("blockquote",[s("p",[a._v("题外话： 我这三个容器启动后一分钟自动退出，使用 "),s("code",[a._v("docker logs kafka-01")]),a._v(" 查看日志，发现报错找不到主机 kafka-02 kafka-03。\n开始排查：")])]),a._v(" "),s("ol",[s("li",[a._v("进入容器：docker exec -it --user root kafka-01 bash")]),a._v(" "),s("li",[a._v("查看网络：ping kafka-02 ，发现网络不通")]),a._v(" "),s("li",[a._v("利用上文的docker network inspect kafka-network 输出的Containers，查看其他容器的ip：kafka-02 172.18.0.3")]),a._v(" "),s("li",[a._v("查看网络：ping 172.18.0.3 发现网络畅通，得知是dns解析问题。不知道docker是怎么处理的。")]),a._v(" "),s("li",[a._v('自行写入hosts文件：\n* docker exec -it --user root kafka-01 bash\n* echo "172.18.0.2 kafka-01" >> /etc/hosts\necho "172.18.0.3 kafka-02" >> /etc/hosts\necho "172.18.0.4 kafka-03" >> /etc/hosts')]),a._v(" "),s("li",[a._v("再ping kafka-02，网络正常。后续排查docker的域名解析再更新")])])])}),[],!1,null,null,null);s.default=r.exports}}]);